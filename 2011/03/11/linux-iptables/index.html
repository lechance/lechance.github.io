<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Lechance">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://lechance.github.io/2011/03/11/linux-iptables/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="Iptables glossary:TARGET: When using iptables, a target is an action you want Iptables to apply when a packet matches a rule. CHAIN: A chain is a list of rules; available built-in chains are: INPUT, O">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux Iptables">
<meta property="og:url" content="https://lechance.github.io/2011/03/11/linux-iptables/index.html">
<meta property="og:site_name" content="Lechance&#39;s Blog">
<meta property="og:description" content="Iptables glossary:TARGET: When using iptables, a target is an action you want Iptables to apply when a packet matches a rule. CHAIN: A chain is a list of rules; available built-in chains are: INPUT, O">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://linuxhint.com/wp-content/uploads/2021/05/image6-37.png">
<meta property="og:image" content="https://linuxhint.com/wp-content/uploads/2021/05/image9-31.png">
<meta property="og:image" content="https://linuxhint.com/wp-content/uploads/2021/05/image8-35.png">
<meta property="og:image" content="https://linuxhint.com/wp-content/uploads/2021/05/image12-19.png">
<meta property="og:image" content="https://linuxhint.com/wp-content/uploads/2021/05/image10-27.png">
<meta property="og:image" content="https://linuxhint.com/wp-content/uploads/2021/05/image11-24.png">
<meta property="article:published_time" content="2011-03-10T16:00:00.000Z">
<meta property="article:modified_time" content="2024-07-20T02:23:26.485Z">
<meta property="article:author" content="Lechance Cheung">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="iptables">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://linuxhint.com/wp-content/uploads/2021/05/image6-37.png">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/redefine-favicon.svg" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/redefine-favicon.svg">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/redefine-favicon.svg">
    <!--- Page Info-->
    
    <title>
        
            Linux Iptables -
        
        Lechance&#39;s Blog
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    

    
        
<script src="/js/libs/anime.min.js"></script>

    

    <script id="hexo-configurations">
    window.config = {"hostname":"lechance.github.io","root":"/","language":"en","path":"search.xml"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":["MVP"]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":3,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"Suggestion","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":true,"open_graph":true,"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/wallhaven-wqery6-light.webp","dark":"/images/wallhaven-wqery6-dark.webp"},"title":"...","subtitle":{"text":["Loading..."],"hitokoto":{"enable":true,"api":"https://v1.hitokoto.cn?c=i&c=h&c=d&c=e&c=k"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":"https://github.com/lechance/","instagram":null,"zhihu":null,"twitter":null,"email":"lechance@gmail.com"},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.6.4","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"Categories":{"path":"/categories","icon":"fa-solid fa-table-list"},"links":{"icon":"fa-regular fa-link","submenus":{"About":"/about","Essay":"/essays","Gallery":"/masonry","Bookmark":"/links"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"stay hungry stay foolish","show_on_mobile":true,"links":null},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2023/5/28 13:14:00"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":true};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>



    <style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    <h2 class="ml13">
        Lechance&#39;s Blog
    </h2>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });

        var animation = anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [40,0],
                translateZ: 0,
                opacity: [0,1],
                filter: ['blur(5px)', 'blur(0px)'], // Starting from blurred to unblurred
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i,
            }).add({
                targets: '.ml13 .letter',
                translateY: [0,-40],
                opacity: [1,0],
                filter: ['blur(0px)', 'blur(5px)'], // Ending from unblurred to blurred
                easing: "easeInExpo",
                duration: 1200,
                delay: (el, i) => 100 + 30 * i,
                complete: function() {
                    hidePreloader(); // Call hidePreloader after the animation completes
                }
            });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            setTimeout(hidePreloader, 5000); // Call hidePreloader after 5000 milliseconds if not already called by animation
        });

        function hidePreloader() {
            var preloader = document.querySelector('.preloader');
            preloader.style.opacity = '0';
            setTimeout(function () {
                preloader.style.display = 'none';
            }, 200);
        }
    </script>
</div>

<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">

    <div class="navbar-content ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                Lechance&#39;s Blog
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    ARCHIVES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories"
                                        >
                                    <i class="fa-solid fa-table-list fa-fw"></i>
                                    CATEGORIES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-link fa-fw"></i>
                                    LINKS
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/about">
                                                    ABOUT
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/essays">
                                                    ESSAY
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/masonry">
                                                    GALLERY
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/links">
                                                    BOOKMARK
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                ARCHIVES
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories"
                        >
                            <span>
                                CATEGORIES
                            </span>
                            
                                <i class="fa-solid fa-table-list fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-links"
                        >
                            <span>
                                LINKS
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-links">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/about">ABOUT</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/essays">ESSAY</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/masonry">GALLERY</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/links">BOOKMARK</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">101</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">20</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">64</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                <div class="w-full flex items-center pt-6 justify-start">
                    <h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Linux Iptables</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="/images/redefine-avatar.svg">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Lechance</span>
                        
                            <span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">MVP</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2011-03-11</span>
        <span class="mobile">2011-03-11</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-07-20 10:23:26</span>
            <span class="mobile">2024-07-20 10:23:26</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Linux/">Linux</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/linux/">linux</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/iptables/">iptables</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>36k Words</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>2:10 Mins</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h2 id="Iptables-glossary"><a href="#Iptables-glossary" class="headerlink" title="Iptables glossary:"></a>Iptables glossary:</h2><p><strong>TARGET</strong>: When using iptables, a target is an action you want Iptables to apply when a packet matches a rule.</p>
<p><strong>CHAIN</strong>: A chain is a list of rules; available built-in chains are: <strong>INPUT, OUTPUT, FORWARD, PREROUTING, and POSTROUTING</strong>.</p>
<p><strong>TABLE</strong>: Tables are iptables features for each purpose. For example, there is a table for routing tasks and another table for filtering tasks; each table contains rule chains.</p>
<p>Available tables are filter, nat, raw, security, and mangle. Each table contains built-in (rule) chains. The following list shows what chains include each table:</p>
<table>
<thead>
<tr>
<th align="center">Tables</th>
<th align="center"></th>
<th align="center">-</th>
<th align="center">-</th>
<th align="center">-</th>
<th align="center">-</th>
</tr>
</thead>
<tbody><tr>
<td align="center">FILTER</td>
<td align="center">INPUT</td>
<td align="center">OUTPUT</td>
<td align="center">FORWARD</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">NAT</td>
<td align="center">PREROUTING</td>
<td align="center">POSTROUTING</td>
<td align="center">OUTPUT</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">RAW</td>
<td align="center">PREROUTING</td>
<td align="center">OUTPUT</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr>
<td align="center">MANGLE</td>
<td align="center">PREROUTING</td>
<td align="center">POSTROUTING</td>
<td align="center">OUTPUT</td>
<td align="center">INPUT</td>
<td align="center">FORWARD</td>
</tr>
</tbody></table>
<p>Depending on the action you want iptables to do, you need to specify a table using the option -t followed by the table name. In this tutorial, the option -t isn’t used. This tutorial focuses on filtering purposes using the filter table applied by default when the option -t isn’t passed. While reading this tutorial, you will learn some of the concepts mentioned above.</p>
<h2 id="Getting-started-with-Iptables"><a href="#Getting-started-with-Iptables" class="headerlink" title="Getting started with Iptables:"></a>Getting started with Iptables:</h2><p>Before starting, check for previous rules by instructing iptables to list existing policies and rules using the -L (–list) parameter.</p>
<pre><code>sudo iptables -L
</code></pre>
<p>The output above shows 3 rows: <strong>Chain INPUT, Chain FORWARD, and Chain OUTPUT</strong>. Where <strong>INPUT</strong> refers to policies regarding incoming traffic, <strong>OUTPUT</strong> refers to policies applied to outgoing traffic, and <strong>FORWARD</strong> refers to routing policies.</p>
<p>The output also shows there are no defined rules, and all defined policies are accepted.</p>
<p>There are 3 types of policies: <strong>ACCEPT, REJECT and DROP</strong>.</p>
<p>The policy <strong>ACCEPT</strong> allows connections; the policy <strong>REJECT</strong> refuses connections returning an error; the policy <strong>DROP</strong> refuses connections without producing errors.<br>When using <strong>DROP</strong>, <strong>UDP</strong> packets are dropped, and the behavior will be the same as connecting to a port with no service. <strong>TCP</strong> packets will return an <strong>ACK&#x2F;RST</strong>, which is the same response that an open port with no service on it will respond with. When using <strong>REJECT</strong>, an ICMP packet returns destination-unreachable to the source host.</p>
<p>When you deal with Iptables, you need first to define the three policies for each chain; after that, you can add exceptions and specifications. Adding policies looks like this:</p>
<pre><code>sudo iptables -P INPUT     &lt;ACCEPT/DROP/REJECT&gt;
sudo iptables -P OUTPUT   &lt;ACCEPT/DROP/REJECT&gt;
sudo iptables -P FORWARD &lt;ACCEPT/DROP/REJECT&gt;
</code></pre>
<p><strong>Iptables permissive and restrictive policies:</strong></p>
<p>You can apply Iptables with a permissive policy by accepting all incoming connections except for these you specifically drop or reject. In this case, every connection is allowed unless you define a rule to refuse it specifically.</p>
<p>On the contrary, restrictive policies refuse all connections except for these you specifically accept. In this case, every connection is refused unless you define a rule to accept it.</p>
<p><strong>Applying a restrictive policy with Iptables:</strong></p>
<p>The following example shows how to apply a restrictive policy with Iptables by dropping all incoming traffic except for the allowed.</p>
<p><strong>Blocking incoming traffic.</strong></p>
<p><strong>IMPORTANT</strong>: applying the following 3 rules may leave you without an internet connection. Using the rules mentioned in “<a class="link"   target="_blank" rel="noopener" href="https://docs.google.com/document/d/1hvVg2PYZxPYNfvwL3ILDzJRXaW7mZk9fb8z0PgyisCLp8ZKzzU20LyrqvbjZfIJodgl7Xw/edit?_gfid=docs_editor_frame&fileUrl=https://cloud-docs-gdd.dropbox.com/fsip/files/id:L05vcXvkRoIAAAAAAADPsw&isInboundFsipRequest=true&jsh=m;/_/scs/apps-static/_/js/k=oz.gapi.en.vQiXRrxCe40.O/am=AQ/d=1/rs=AGLTcCMBxIGVyXSdvvcs43a64yHt_P7dfg/m=__features__&organizationType=CONSUMER&parent=https://gdd.dropbox.com&pfname&previewUrl=https://www.dropbox.com/scl/fi/zyb6sg69kmq0k7xbbps3w/Iptables-tutorial-IvanVanney-haniwriter.docx?cloud_editor=preview&dl=0&web_open_id=web_open_id-b1e2faa055cf5b79&rpctoken=20221183&tpat=cd.ACUtFvBe3lv9EuSGBWPHp4_XfyPro3IWkVgd4J8F0kU8XbrRXF4qVwmfIYq_Du_Da7jLzId3IdEjNaGyXF5QyopAJBRSUKHiZm0zHAXpkUObO3P9BGI86oq5AuYeJoYUSw-QBQgdOYLd4lhS-JDpaR5OeXVzElYa-XPvnTMNgjg7UM2LYpgdyzFZMpZri7BVtssRwg9zXdiyOj25v7XUyg0-Tg_HQ9lZfO6xmsN2HIHXm_cfdOZpYEpQ_gSnItevoHMb99gqDt8mYwPEhyJ_k6AMMnxMQHrW2s3E_uDozH9vy6p78_VjcSNZkuqu0Db7eGQdedFDJ6jvX0qELKF6ONOeFGZJAMUXTnjk_c689kAp5FBqEQTYsNnz0aIWsncQJVwRidz0s_AMMHxItU4kFKXYB-nsu6NzJ50a-54vaEJUbC-_n1CaX6sSNZ4OT6hN6aURRGZAqreEW2jIk05PwuW8tMZwR2qE1f67jNFSBcw9txZRdaqYWAHwVLzdWzp-S1k_gnVI9LISAJNa_S7kqC1fsTutscbFkmKnblsekz6IS8fIkoTLcwJRxPlai3ktxllSvoG_H7XIb5t4zVWy4J2I_v2OpP38xagrtUcxFxSBHnyqq47kgVHpXRYAC0UJJXYInTZSiYMfDPjBh59VMdVto--fl8DldKamMubZxkcw2U63tXRxkiaVrvrqX0q4d1EfaSTeiE7PUvqsOHJQ1OEo_05-TkneRgRohprTyHJOAfcqRyGW-vS4ShTpJdKNcSuhw_WlhBSQGXfyK8NQTUCXPPep7-JfPZs-D-mFWYnzfQ==&tpatExpirationTime=1623019860000&usegapi=1#bookmark=id.gjdgxs" >Iptables Appending rules and Iptables states <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>,” you add the necessary exceptions to restore your access to the internet. You can consistently execute sudo iptables -F to flush rules.</p>
<p>You can block all incoming traffic, allowing only outgoing traffic to browse the web and for applications you need.</p>
<p>sudo iptables -P INPUT DROP</p>
<p>sudo iptables -P OUTPUT ACCEPT</p>
<p>sudo iptables -P FORWARD DROP</p>
<p>Where:</p>
<p><strong>-P &#x3D; Policy</strong></p>
<p><strong>sudo iptables -P INPUT DROP</strong>: instruct iptables to refuse all incoming traffic without replying to the source.</p>
<p><strong>sudo iptables -P OUTPUT ACCEPT</strong>: defines an ACCEPT policy for outgoing traffic.</p>
<p><strong>sudo iptables -P FORWARD DROP</strong>: instructs iptables not to execute routing tasks dropping all packets destined to a different host (trying to pass through the firewalled device) without reply.</p>
<p>The example above allows browsing the web and connections started by the local device (<strong>-P OUTPUT ACCEPT</strong>) but will prevent connections initiated by another host (<strong>-P INPUT DROP</strong>) like ssh attempts to access your device not return error messages.</p>
<p>When you enable Iptables with a restrictive policy like in the previous example, you need to append rules to adjust your configuration. For example, if you keep the configuration mentioned above without adding a reasonable exception for the loopback (lo) interface, some applications may not work correctly. You will also need to allow incoming traffic belonging to or related to a connection started by your device.</p>
<h2 id="Iptables-Appending-rules-and-Iptables-states"><a href="#Iptables-Appending-rules-and-Iptables-states" class="headerlink" title="Iptables Appending rules and Iptables states"></a>Iptables Appending rules and Iptables states</h2><p>It is essential to understand that Iptables applies rules by order. When you define a rule after a previous rule, the second rule will rewrite the last if a packet matches the same rule.</p>
<p>I like the previous example; you blocked all incoming traffic, you need to append exceptions for the loopback interface; this can be achieved by adding the -A (Append) parameter.</p>
<pre><code>sudo iptables -A INPUT -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT

sudo iptables -A OUTPUT -m conntrack --ctstate ESTABLISHED -j ACCEPT
</code></pre>
<p>The module (-m) conntrack –ctstate <strong>ESTABLISHED,RELATED</strong> instructs Iptables to confirm if the connection state is <strong>ESTABLISHED or RELATED</strong> to an existing connection before applying the defined rule policy.</p>
<p>There are 4 possible states Iptables can check:</p>
<p><strong>Iptables state NEW</strong>: The packet or traffic you allow or block tries to start a new connection.</p>
<p><strong>Iptables state ESTABLISHED</strong>: The packet or traffic you allow or block is part of an established connection.</p>
<p><strong>Iptables state RELATED</strong>: The packet or traffic starts a new connection but is related to an existing connection.</p>
<p><strong>Iptables state INVALID</strong>: The packet or traffic is unknown without the state.</p>
<p>The first line of the example above instructs Iptables to accept incoming packets from the traffic coming from or related to connections started by your device. The second line instructs Iptables to accept only outgoing traffic from already established connections.</p>
<h2 id="Iptables-Append-to-accept-loopback-traffic-and-defining-interfaces"><a href="#Iptables-Append-to-accept-loopback-traffic-and-defining-interfaces" class="headerlink" title="Iptables Append to accept loopback traffic and defining interfaces:"></a>Iptables Append to accept loopback traffic and defining interfaces:</h2><p>The loopback interface is used by programs that need to interact with the localhost. If you don’t allow loopback traffic, some applications may not work.</p>
<p>The following command allows loopback connections:</p>
<p>sudo iptables -A INPUT -i lo -j ACCEPT</p>
<p>sudo iptables -A OUTPUT -o lo -j ACCEPT</p>
<p>Where -i and -o are used to specify the network device for incoming traffic (-i) and outgoing traffic (-o).</p>
<h2 id="Applying-a-permissive-policy-with-Iptables"><a href="#Applying-a-permissive-policy-with-Iptables" class="headerlink" title="Applying a permissive policy with Iptables:"></a>Applying a permissive policy with Iptables:</h2><p>You can also define a permissive policy allowing all traffic except for the specified dropped or rejected. You can enable everything except a specific IP or IP range, or you can refuse packets based on their headers, among more possibilities.</p>
<p>The following example shows how to apply a permissive policy allowing all traffic except for an IP range blocked for the ssh service.</p>
<pre><code>sudo iptables -P INPUT ACCEPT

sudo iptables -P OUTPUT ACCEPT

sudo iptables -P FORWARD DROP

sudo iptables -A INPUT -p tcp --dport 22 -m iprange --src-range 192.168.1.100-192.168.1.110 -j REJECT
</code></pre>
<p>The example above applies a permissive policy but blocks ssh access to all IPs belonging to the range 192.168.1.100 and 192.168.1.110.</p>
<p>Where -p specifies the protocol, –dport (or –destination-port) the destination port (22,ssh), and the module iprange with the argument –src-range (source range) allows defining the IP range. The option -j (–jump) instructs iptables what to do with the packet; in this case, we represent REJECT.</p>
<h2 id="Blocking-ports-with-Iptables"><a href="#Blocking-ports-with-Iptables" class="headerlink" title="Blocking ports with Iptables"></a>Blocking ports with Iptables</h2><p>The following example shows how to block a specific port for all connections, the ssh port.</p>
<p>sudo iptables -A INPUT -p tcp –destination-port 22 -j DROP</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://linuxhint.com/wp-content/uploads/2021/05/image6-37.png"
                      alt="img"
                ></p>
<h2 id="Saving-Iptables-changes"><a href="#Saving-Iptables-changes" class="headerlink" title="Saving Iptables changes"></a>Saving Iptables changes</h2><p>Iptables rules are not persistent; after rebooting, the rules will not be restored. To make your rules persistent, run the following commands where the first line saves the rules in the file &#x2F;etc&#x2F;iptables.up.rules, and the second line is to create the file for iptables to start after reboot.</p>
<p>sudo iptables-save &gt; &#x2F;etc&#x2F;iptables.up.rules</p>
<p>nano &#x2F;etc&#x2F;network&#x2F;if-pre-up.d&#x2F;iptables</p>
<p>Add the following to the file and close saving changes (CTRL+X).</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://linuxhint.com/wp-content/uploads/2021/05/image9-31.png"
                      alt="img"
                ></p>
<p><em>#!&#x2F;bin&#x2F;sh</em><br>&#x2F;sbin&#x2F;iptables-restore &lt; &#x2F;etc&#x2F;iptables.up.rules</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://linuxhint.com/wp-content/uploads/2021/05/image8-35.png"
                      alt="img"
                ></p>
<p>Finally, give the file execution permissions by running:</p>
<p>chmod +x &#x2F;etc&#x2F;network&#x2F;if-pre-up.d&#x2F;iptables</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://linuxhint.com/wp-content/uploads/2021/05/image12-19.png"
                      alt="img"
                ></p>
<h2 id="Flushing-or-removing-Iptables-rules"><a href="#Flushing-or-removing-Iptables-rules" class="headerlink" title="Flushing or removing Iptables rules:"></a>Flushing or removing Iptables rules:</h2><p>You can remove all your Iptables rules by running the following command:</p>
<p>sudo iptables -F</p>
<p><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://linuxhint.com/wp-content/uploads/2021/05/image10-27.png"
                      alt="img"
                ></p>
<p>To remove a specific chain like INPUT, you can run:</p>
<p>sudo iptables -F</p>
<h2 id=""><a href="#" class="headerlink" title=""></a><img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://linuxhint.com/wp-content/uploads/2021/05/image11-24.png"
                      alt="img"
                ></h2><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion:"></a>Conclusion:</h2><p>Iptables are among the most sophisticated and flexible firewalls in the market. Despite being replaced, it remains as one of the most spread defensive and routing software.</p>
<p>Its implementation can be quickly learned by new Linux users with basic knowledge of TCP&#x2F;IP. Once users understand the syntax, defining rules becomes an easy task.</p>
<p>There are a lot more additional modules and options that weren’t covered by this introductive tutorial. You can see more iptables examples at <a class="link"   target="_blank" rel="noopener" href="https://linuxhint.com/iptables_for_beginners/" >Iptables for beginners <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>.</p>
<p>I hope this Iptables tutorial was helpful. Keep following Linux Hint for more Linux tips and tutorials.</p>
<hr>
<h3 id="View"><a href="#View" class="headerlink" title="View"></a>View</h3><pre><code>iptables -nvL –line-number
</code></pre>
<h3 id="Add-Insert"><a href="#Add-Insert" class="headerlink" title="Add&#x2F;Insert"></a>Add&#x2F;Insert</h3><p>添加规则有两个参数：-A和-I。其中-A是添加到规则的末尾；-I可以插入到指定位置，没有指定位置的话默认插入到规则的首部。</p>
<pre><code>iptables -A INPUT -s 192.168.1.5 -j DROP
//or
iptables -I INPUT 3 -s 192.168.1.3 -j DROP
</code></pre>
<h3 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h3><pre><code>iptables -D INPUT -s 192.168.1.5 -j DROP
//or with --line-number to delete
iptables -D INPUT 2
</code></pre>
<h3 id="Modify"><a href="#Modify" class="headerlink" title="Modify"></a>Modify</h3><pre><code>iptables -R INPUT 3 -j ACCEPT
</code></pre>
<div style="margin:150px;"></div>

<h3 id="Iptables"><a href="#Iptables" class="headerlink" title="Iptables"></a>Iptables</h3><p><a class="link"   target="_blank" rel="noopener" href="https://www.linode.com/docs/security/firewalls/control-network-traffic-with-iptables/" >https://www.linode.com/docs/security/firewalls/control-network-traffic-with-iptables/ <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h4 id="General-format"><a href="#General-format" class="headerlink" title="General format"></a>General format</h4><p>the following command adds a rule to the beginning of the chain that will drop all packets from the address <code>198.51.100.0</code>:</p>
<pre><code>iptables -I INPUT -s 198.51.100.0 -j DROP
</code></pre>
<p>The sample command above:</p>
<ol>
<li>Calls the iptables program</li>
<li>Uses the -I option for insertion. Using a rule with the insertion option will add it to the beginning of a chain and will be applied first. To indicate a specific placement in the chain, you may also use a number with the -I option.</li>
<li>The <code>-s</code> parameter, along with the IP address (198.51.100.0), indicates the source.</li>
<li>Finally, the <code>-j</code> parameter stands for jump. It specifies the target of the rule and what action will be performed if the packet is a match.</li>
</ol>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>-p, --protocol</code></td>
<td>The protocol, such as TCP, UDP, etc.</td>
</tr>
<tr>
<td><code>-s, --source</code></td>
<td>Can be an address, network name, hostname, etc.</td>
</tr>
<tr>
<td><code>-d, --destination</code></td>
<td>An address, hostname, network name, etc.</td>
</tr>
<tr>
<td><code>-j, --jump</code></td>
<td>Specifies the target of the rule; i.e. what to do if the packet matches.</td>
</tr>
<tr>
<td><code>-g, --goto chain</code></td>
<td>Specifies that the processing will continue in a user-specified chain.</td>
</tr>
<tr>
<td><code>-i, --in-interface</code></td>
<td>Names the interface from where packets are received.</td>
</tr>
<tr>
<td><code>-o, --out-interface</code></td>
<td>Name of the interface by which a packet is being sent.</td>
</tr>
<tr>
<td><code>-f, --fragment</code></td>
<td>The rule will only be applied to the second and subsequent fragments of fragmented packets.</td>
</tr>
<tr>
<td><code>-c, --set-counters</code></td>
<td>Enables the admin to initialize the packet and byte counters of a rule.</td>
</tr>
</tbody></table>
<h4 id="Default-Tables"><a href="#Default-Tables" class="headerlink" title="Default Tables"></a>Default Tables</h4><p>Tables are made up of built-in chains and may also contain user-defined chains. The built-in tables will depend on the kernel configuration and the installed modules.</p>
<p>The default tables are as follows:</p>
<p><strong>Filter</strong> - This is the default table. Its built-in chains are:</p>
<ul>
<li>Input: packets going to local sockets</li>
<li>Forward: packets routed through the server</li>
<li>Output: locally generated packets</li>
</ul>
<p><strong>Nat</strong> - When a packet creates a new connection, this table is used. Its built-in chains are:</p>
<ul>
<li>Prerouting: designating packets when they come in</li>
<li>Output: locally generated packets before routing takes place</li>
<li>Postrouting: altering packets on the way out</li>
</ul>
<p><strong>Mangle</strong> - Used for special altering of packets. Its chains are:</p>
<ul>
<li>Prerouting: incoming packets</li>
<li>Postrouting: outgoing packets</li>
<li>Output: locally generated packets that are being altered</li>
<li>Input: packets coming directly into the server</li>
<li>Forward: packets being routed through the server</li>
</ul>
<p><strong>Raw</strong> - Primarily used for configuring exemptions from connection tracking. The built-in chains are:</p>
<ul>
<li>Prerouting: packets that arrive by the network interface</li>
<li>Output: processes that are locally generated</li>
</ul>
<p><strong>Security</strong> - Used for Mandatory Access Control (MAC) rules. After the filter table, the security table is accessed next. The built-in chains are:</p>
<ul>
<li>Input: packets entering the server</li>
<li>Output: locally generated packets</li>
<li>Forward: packets passing through the server</li>
</ul>
<h4 id="Basic-iptables-Options"><a href="#Basic-iptables-Options" class="headerlink" title="Basic iptables Options"></a>Basic iptables Options</h4><p>There are many options that may be used with the <code>iptables</code> command:</p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>-A --append</code></td>
<td>Add one or more rules to the end of the selected chain.</td>
</tr>
<tr>
<td><code>-C --check</code></td>
<td>Check for a rule matching the specifications in the selected chain.</td>
</tr>
<tr>
<td><code>-D --delete</code></td>
<td>Delete one or more rules from the selected chain.</td>
</tr>
<tr>
<td><code>-F --flush</code></td>
<td>Delete all the rules one-by-one.</td>
</tr>
<tr>
<td><code>-I --insert</code></td>
<td>Insert one or more rules into the selected chain as the given rule number.</td>
</tr>
<tr>
<td><code>-L --list</code></td>
<td>Display the rules in the selected chain.</td>
</tr>
<tr>
<td><code>-n --numeric</code></td>
<td>Display the IP address or hostname and post number in numeric format.</td>
</tr>
<tr>
<td><code>-N --new-chain &lt;name&gt;</code></td>
<td>Create a new user-defined chain.</td>
</tr>
<tr>
<td><code>-v --verbose</code></td>
<td>Provide more information when used with the list option.</td>
</tr>
<tr>
<td><code>-X --delete-chain &lt;name&gt;</code></td>
<td>Delete the user-defined chain.</td>
</tr>
</tbody></table>
<h4 id="Insert-Replace-or-Delete-iptables-Rules"><a href="#Insert-Replace-or-Delete-iptables-Rules" class="headerlink" title="Insert, Replace or Delete iptables Rules"></a>Insert, Replace or Delete iptables Rules</h4><p><strong>iptables</strong> rules are enforced top down, so the first rule in the ruleset is applied to traffic in the chain, then the second, third and so on. This means that rules cannot necessarily be added to a ruleset with <code>iptables -A</code> or <code>ip6tables -A</code>. Instead, rules must be inserted with <code>iptables -I</code> or <code>ip6tables -I</code>.</p>
<h4 id="Insert"><a href="#Insert" class="headerlink" title="Insert"></a>Insert</h4><p>Inserted rules need to be placed in the correct order with respect to other rules in the chain. To get a numerical list of your iptables rules:</p>
<pre><code>sudo iptables -L -nv --line-numbers
</code></pre>
<p>For example, let’s say you want to insert a rule into the <a class="link"   target="_blank" rel="noopener" href="https://www.linode.com/docs/security/firewalls/control-network-traffic-with-iptables/#basic-iptables-rulesets-for-ipv4-and-ipv6" >basic ruleset <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> provided in this guide, that will accept incoming connections to port 8080 over the TCP protocol. We’ll add it as rule 7 to the INPUT chain, following the web traffic rules:</p>
<pre><code>sudo iptables -I INPUT 7 -p tcp --dport 8080 -m state --state NEW -j ACCEPT
</code></pre>
<p>If you now run <code>sudo iptables -L -nv</code> again, you’ll see the rule in the output.</p>
<h4 id="Replace"><a href="#Replace" class="headerlink" title="Replace"></a>Replace</h4><p>Replacing a rule is similar to inserting, but instead uses <code>iptables -R</code>. For example, let’s say you want to reduce the logging of denied entries to only 3 per minute, down from 5 in the original ruleset. The LOG rule is ninth in the INPUT chain:</p>
<pre><code>sudo iptables -R INPUT 9 -m limit --limit 3/min -j LOG --log-prefix &quot;iptables_INPUT_denied:&quot; --log-level 7
</code></pre>
<h3 id="Delete-1"><a href="#Delete-1" class="headerlink" title="Delete"></a>Delete</h3><p>Deleting a rule is also done using the rule number. For example, to delete the rule we just inserted for port 8080:</p>
<pre><code>sudo iptables -D INPUT 7
</code></pre>
<blockquote>
<p><strong>Caution:</strong><br>Editing rules does not automatically save them. See our section on deploying rulesets for the specific instructions for your distribution.</p>
</blockquote>
<h4 id="View-Your-Current-iptables-Rules"><a href="#View-Your-Current-iptables-Rules" class="headerlink" title="View Your Current iptables Rules"></a>View Your Current iptables Rules</h4><pre><code>sudo iptables -L -nv

sudo ip6tables -L nv
</code></pre>
<h3 id="Configure-iptables"><a href="#Configure-iptables" class="headerlink" title="Configure iptables"></a>Configure iptables</h3><p>iptables can be configured and used in a variety of ways. The following sections will outline how to configure rules by port and IP, as well as how to ++blacklist++ (block) or ++whitelist++ (allow) addresses.</p>
<h4 id="Block-Traffic-by-Port"><a href="#Block-Traffic-by-Port" class="headerlink" title="Block Traffic by Port"></a>Block Traffic by Port</h4><p>You may use a port to block all traffic coming in on a specific interface. For example:</p>
<pre><code>sudo iptables -A INPUT -j DROP -p tcp --destination-port 110 -i eth0
</code></pre>
<p>Let’s examine what each part of this command does:</p>
<ul>
<li><code>-A</code> will add or append the rule to the end of the chain.</li>
<li><code>INPUT</code> will add the rule to the table.</li>
<li><code>DROP</code> means the packets are discarded.</li>
<li><code>-p tcp</code> means the rule will only drop TCP packets.</li>
<li><code>--destination-port 110</code> filters packets targeted to port 110.</li>
<li><code>-i eth0</code> means this rule will impact only packets arriving on the eth0 interface.</li>
</ul>
<p>It is important to understand that iptables do not recognize aliases on the network interface. Therefore, if you have several virtual IP interfaces, you will have to specify the destination address to filter the traffic. A sample command is provided below:</p>
<pre><code>sudo iptables -A INPUT -j DROP -p tcp --destination-port 110 -i eth0 -d 195.51.100.0
</code></pre>
<p>You may also use <code>-D</code> or <code>--delete</code> to remove rules. For example, these commands are equivalent:</p>
<pre><code>iptables --delete INPUT -j DROP -p tcp --destination-port 110 -i eth0 -d 198.51.100.0
iptables -D INPUT -j DROP -p tcp --destination-port 110 -i eth0 -d 198.51.100.0
</code></pre>
<h4 id="Drop-Traffic-from-an-IP"><a href="#Drop-Traffic-from-an-IP" class="headerlink" title="Drop Traffic from an IP"></a>Drop Traffic from an IP</h4><p>In order to drop all incoming traffic from a specific IP address, use the iptables command with the following options:</p>
<pre><code>iptables -I INPUT -s 198.51.100.0 -j DROP
</code></pre>
<p>To remove these rules, use the <code>--delete</code> or <code>-D</code> option:</p>
<pre><code>iptables -D INPUT -s 198.51.100.0 -j DROP
</code></pre>
<h4 id="Block-or-Allow-Traffic-by-Port-Number-to-Create-an-iptables-Firewall"><a href="#Block-or-Allow-Traffic-by-Port-Number-to-Create-an-iptables-Firewall" class="headerlink" title="Block or Allow Traffic by Port Number to Create an iptables Firewall"></a>Block or Allow Traffic by Port Number to Create an iptables Firewall</h4><p>One way to create a firewall is to block all traffic to the system and then allow traffic on certain ports. Below is a sample sequence of commands to illustrate the process:</p>
<pre><code>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
iptables -A INPUT -i lo -m comment --comment &quot;Allow loopback connections&quot; -j ACCEPT
iptables -A INPUT -p icmp -m comment --comment &quot;Allow Ping to work as expected&quot; -j ACCEPT
iptables -A INPUT -p tcp -m multiport --destination-ports 22,25,53,80,443,465,5222,5269,5280,8999:9003 -j ACCEPT
iptables -A INPUT -p udp -m multiport --destination-ports 53 -j ACCEPT
iptables -P INPUT DROP
iptables -P FORWARD DROP
</code></pre>
<p>Let’s break down the example above. The first two commands add or append rules to the <code>INPUT</code> chain in order to allow access on specific ports. The <code>-p tcp</code> and <code>-p udp</code> options specify either UDP or TCP packet types. The <code>-m multiport</code> function matches packets on the basis of their source or destination ports, and can accept the specification of up to 15 ports. Multiport also accepts ranges such as <code>8999:9003</code> which counts as 2 of the 15 possible ports, but matches ports <code>8999</code>, <code>9000</code>, <code>9001</code>, <code>9002</code>, and <code>9003</code>. The next command allows all incoming and outgoing packets that are associated with existing connections so that they will not be inadvertently blocked by the firewall. The final two commands use the -P option to describe the default policy for these chains. As a result, all packets processed by <code>INPUT</code> and <code>FORWARD</code> will be dropped by default.</p>
<p>Note that the rules described above only control incoming packets, and do not limit outgoing connections.</p>
<h4 id="Whitelist-Blacklist-Traffic-by-Address"><a href="#Whitelist-Blacklist-Traffic-by-Address" class="headerlink" title="Whitelist&#x2F;Blacklist Traffic by Address"></a>Whitelist&#x2F;Blacklist Traffic by Address</h4><p>You can use iptables to block all traffic and then only allow traffic from certain IP addresses. These firewall rules limit access to specific resources at the network layer. Below is an example sequence of commands:</p>
<div class="highlight-container" data-rel="Sh"><figure class="iseeu highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line">iptables -A INPUT -i lo -m comment --comment <span class="string">&quot;Allow loopback connections&quot;</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT -p icmp -m comment --comment <span class="string">&quot;Allow Ping to work as expected&quot;</span> -j ACCEPT</span><br><span class="line">iptables -A INPUT -s 192.168.1.0/24 -j ACCEPT</span><br><span class="line">iptables -A INPUT -s 198.51.100.0 -j ACCEPT</span><br><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -P FORWARD DROP</span><br></pre></td></tr></table></figure></div>

<div style="margin:320px;" />
---

<p>Each chain is a list of rules; each rule is a set of conditions and an action to execute when the conditions are met. When processing a packet, the firewall scans the appropriate chain, one rule after another; when the conditions for one rule are met, it “jumps” (hence the -j option in the commands) to the specified action to continue processing. The most common behaviors are standardized, and dedicated actions exist for them. Taking one of these standard actions interrupts the processing of the chain, since the packet’s fate is already sealed (barring an exception mentioned below):</p>
<p>BACK TO BASICS ICMP</p>
<blockquote>
<p>ICMP (Internet Control Message Protocol) is the protocol used to transmit complementary information on communications. It allows testing network connectivity with the ping command (which sends an ICMP echo request message, which the recipient is meant to answer with an ICMP echo reply message). It signals a firewall rejecting a packet, indicates an overflow in a receive buffer, proposes a better route for the next packets in the connection, and so on. This protocol is defined by several RFC documents; the initial RFC777 and RFC792 were soon completed and extended.<br>→ <a class="link"   target="_blank" rel="noopener" href="http://www.faqs.org/rfcs/rfc777.html" >http://www.faqs.org/rfcs/rfc777.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>→ <a class="link"   target="_blank" rel="noopener" href="http://www.faqs.org/rfcs/rfc792.html" >http://www.faqs.org/rfcs/rfc792.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a><br>For reference, a receive buffer is a small memory zone storing data between the time it arrives from the network and the time the kernel handles it. If this zone is full, new data cannot be received, and ICMP signals the problem, so that the emitter can slow down its transfer rate (which should ideally reach an equilibrium after some time).<br>Note that although an IPv4 network can work without ICMP, ICMPv6 is strictly required for an IPv6 network, since it combines several functions that were, in the IPv4 world, spread across ICMPv4, IGMP (Internet Group Membership Protocol) and ARP (Address Resolution Protocol). ICMPv6 is defined in RFC4443.<br>→ <a class="link"   target="_blank" rel="noopener" href="http://www.faqs.org/rfcs/rfc4443.html" >http://www.faqs.org/rfcs/rfc4443.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
</blockquote>
<p><strong>ACCEPT</strong>: allow the packet to go on its way;</p>
<p><strong>REJECT</strong>: reject the packet with an ICMP error packet (the –reject-with type option to iptables allows selecting the type of error);</p>
<p><strong>DROP</strong>: delete (ignore) the packet;</p>
<p><strong>LOG</strong>: log (via syslogd) a message with a description of the packet; note that this action does not interrupt processing, and the execution of the chain continues at the next rule, which is why logging refused packets requires both a LOG and a REJECT&#x2F;DROP rule;</p>
<p><strong>ULOG</strong>: log a message via ulogd, which can be better adapted and more efficient than syslogd for handling large numbers of messages; note that this action, like LOG, also returns processing to the next rule in the calling chain;<br>chain_name: jump to the given chain and evaluate its rules;</p>
<p><strong>RETURN</strong>: interrupt processing of the current chain, and return to the calling chain; in case the current chain is a standard one, there’s no calling chain, so the default action (defined with the -P option to iptables) is executed instead;</p>
<p><strong>SNAT</strong> (only in the nat table): apply Source NAT (extra options describe the exact changes to apply);</p>
<p><strong>DNAT</strong> (only in the nat table): apply Destination NAT (extra options describe the exact changes to apply);</p>
<p><strong>MASQUERADE</strong> (only in the nat table): apply masquerading (a special case of Source NAT);</p>
<p><strong>REDIRECT</strong> (only in the nat table): redirect a packet to a given port of the firewall itself; this can be used to set up a transparent web proxy that works with no configuration on the client side, since the client thinks it connects to the recipient whereas the communications actually go through the proxy.<br>Other actions, particularly those concerning the mangle table, are outside the scope of this text. The iptables(8) and ip6tables(8) have a comprehensive list.</p>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Linux Iptables</li>
        <li><strong>Author:</strong> Lechance</li>
        <li><strong>Created at
                :</strong> 2011-03-11 00:00:00</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2024-07-20 10:23:26
            </li>
        
        <li>
            <strong>Link:</strong> https://lechance.github.io/2011/03/11/linux-iptables/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/linux/">#linux</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/iptables/">#iptables</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2011/03/11/Linux-interfaces-ip-link/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Introduction to Linux interfaces for virtual networking</span>
                                <span class="post-nav-item">Prev posts</span>
                            </span>
                        </a>
                    </div>
                
                
            </div>
        


        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">On this page</div>
        <div class="page-title">Linux Iptables</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Iptables-glossary"><span class="nav-text">Iptables glossary:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Getting-started-with-Iptables"><span class="nav-text">Getting started with Iptables:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Iptables-Appending-rules-and-Iptables-states"><span class="nav-text">Iptables Appending rules and Iptables states</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Iptables-Append-to-accept-loopback-traffic-and-defining-interfaces"><span class="nav-text">Iptables Append to accept loopback traffic and defining interfaces:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Applying-a-permissive-policy-with-Iptables"><span class="nav-text">Applying a permissive policy with Iptables:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Blocking-ports-with-Iptables"><span class="nav-text">Blocking ports with Iptables</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Saving-Iptables-changes"><span class="nav-text">Saving Iptables changes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Flushing-or-removing-Iptables-rules"><span class="nav-text">Flushing or removing Iptables rules:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-text"></span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Conclusion"><span class="nav-text">Conclusion:</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#View"><span class="nav-text">View</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Add-Insert"><span class="nav-text">Add&#x2F;Insert</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delete"><span class="nav-text">Delete</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Modify"><span class="nav-text">Modify</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Iptables"><span class="nav-text">Iptables</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delete-1"><span class="nav-text">Delete</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Configure-iptables"><span class="nav-text">Configure iptables</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2023</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">Lechance</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        64 posts in total
                    </span>
                    
                        <span>
                            58k words in total
                        </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.4</a></span>
        </div>
        
        
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="Search..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>



    
<script src="/js/tools/localSearch.js" type="module"></script>




    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>






  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>




    
<script src="/js/libs/minimasonry.min.js"></script>

    
<script src="/js/plugins/masonry.js" type="module"></script>





<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
